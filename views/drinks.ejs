<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title><%= category %> | Bubble Tea</title>
  <link rel="stylesheet" href="/styles/menu.css"/>
</head>
<body>
  <header>
    <h1>üßã ShareTea</h1>
    <nav>
      <ul class="category-header">
        <li><a href="/menu">‚Üê Back to Categories</a></li>
      </ul>
    </nav>
  </header>

  <main>
    <h2><%= category %></h2>

    <% if (drinks.length === 0) { %>
      <p class="no-drinks">No drinks available in this category yet!</p>
    <% } else { %>
      <div class="drinks-container">
        <% drinks.forEach(drink => { %>
          <div class="drink-item">
            <div class="drink-click" data-drink="<%= drink.drinkname %>">
              <img src="/images/<%= drink.image_url %>" alt="<%= drink.drinkname %>"/>
            </div>
            <h3><%= drink.drinkname %></h3>
            <p class="price">$<%= drink.price %></p>
          </div>
        <% }); %>
      </div>
    <% } %>
  </main>

  <!-- Modal -->
  <div id="customization-modal" class="modal hidden">
    <div class="modal-content">
      <span class="close-button">&times;</span>
      <h3 id="selected-drink-name">Customize Your Drink</h3>

      <div class="custom-section">
        <label>Sugar:</label>
        <div class="options">
          <% [0, 20, 40, 60, 80, 100].forEach(level => { %>
            <button class="option-btn sugar-btn"><%= level %>%</button>
          <% }); %>
        </div>
      </div>

      <div class="custom-section">
        <label>Ice:</label>
        <div class="options">
          <% [0, 20, 40, 60, 80, 100].forEach(level => { %>
            <button class="option-btn ice-btn"><%= level %>%</button>
          <% }); %>
        </div>
      </div>

      <div class="custom-section">
        <label>Toppings:</label>
        <div class="options">
          <% toppings.forEach(topping => { %>
            <button class="option-btn topping-btn"><%= topping %></button>
          <% }); %>
        </div>
      </div>

      <button class="confirm-btn">Add to Order</button>
    </div>
  </div>

  <script>
    const modal = document.getElementById("customization-modal");
    const closeButton = document.querySelector(".close-button");
    const drinkNameDisplay = document.getElementById("selected-drink-name");

    // Show modal on drink image click
    document.querySelectorAll(".drink-click").forEach(item => {
        item.addEventListener("click", () => {
            drinkNameDisplay.textContent = "Customize: " + item.dataset.drink;

            // Clear all previous selections
            document.querySelectorAll(".option-btn").forEach(btn => btn.classList.remove("selected"));

            modal.classList.remove("hidden");
        });
    });

    // Close modal
    closeButton.addEventListener("click", () => {
        modal.classList.add("hidden");
    });

    window.addEventListener("click", (event) => {
        if (event.target === modal) {
            modal.classList.add("hidden");
        }
    });

    // need to make sure only one customuzation of ice and sugar is selected
    document.querySelectorAll(".sugar-btn, .ice-btn").forEach(button => {
        button.addEventListener("click", () => {
            const group = button.classList.contains("sugar-btn") ? ".sugar-btn" : ".ice-btn";
            document.querySelectorAll(group).forEach(btn => btn.classList.remove("selected"));
            button.classList.add("selected");
        });
    });

    // customers can however have as many toppings as they want
    document.querySelectorAll(".topping-btn").forEach(button => {
        button.addEventListener("click", () => {
            button.classList.toggle("selected");
        });
    });
  </script>
</body>
</html>
